---
// Drawer.astro
---

<button
  id="drawer-trigger"
  class="bg-transparent focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 d focus:outline-none dark:focus:ring-blue-800"
  type="button"
>
  <svg
    class="flex-shrink-0 w-8 h-8 text-gray-500 transition duration-75 group-hover:text-gray-900 dark:text-gray-400 dark:group-hover:text-white"
    viewBox="0 0 24 24"
    data-name="Flat Line"
    xmlns="http://www.w3.org/2000/svg"
    ><path
      d="M3 12h18M9 18h12M3 6h12"
      style="fill:none;stroke:#3b82f6;stroke-linecap:round;stroke-linejoin:round;stroke-width:2"
    ></path></svg
  >
</button>

<div
  id="drawer"
  class="flex flex-col justify-between fixed top-0 left-0 z-40 h-screen p-4 overflow-y-auto transition-transform -translate-x-full bg-white w-64 dark:bg-gray-800"
  tabindex="-1"
>
  <div class="py-4 overflow-y-auto">
    <ul class="space-y-2 font-medium">
      <h1 class="text-white font-medium text-center">Empresas</h1>
      <li>
        <button
          type="button"
          class="flex items-center w-full p-2 text-base text-gray-900 transition duration-75 rounded-lg group hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700"
          aria-controls="dropdown-clickcb"
          data-collapse-toggle="dropdown-clickcb"
        >
          <svg
            class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 group-hover:text-gray-900 dark:text-gray-400 dark:group-hover:text-white"
            viewBox="-2 0 16 16"
            fill="currentColor"
            xmlns="http://www.w3.org/2000/svg"
            ><path
              data-name="Path 133"
              d="M10.5 0h-9A1.5 1.5 0 0 0 0 1.5V16h12V1.5A1.5 1.5 0 0 0 10.5 0M5 15v-3h2v3Zm6 0H8v-3.5a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5V15H1V1.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 .5.5ZM3 3h2v2H3Zm4 0h2v2H7ZM3 7h2v2H3Zm4 0h2v2H7Z"
            ></path></svg
          >
          <span class="flex-1 ms-3 text-left rtl:text-right whitespace-wrap"
            >ClickCB</span
          >
          <svg
            class="w-3 h-3"
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 10 6"
          >
            <path
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="m1 1 4 4 4-4"></path>
          </svg>
        </button>
        <ul id="dropdown-clickcb" class="dropdown-content py-2 space-y-2">
          <li>
            <a
              href="/dashboard"
              class="flex items-center w-full p-2 text-gray-900 transition duration-75 rounded-lg pl-11 group hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700"
            >
              ClickCB 1
            </a>
          </li>
          <li>
            <a
              href="/dashboard"
              class="flex items-center w-full p-2 text-gray-900 transition duration-75 rounded-lg pl-11 group hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700"
            >
              ClickCB 2
            </a>
          </li>
          <li>
            <a
              href="/dashboard"
              class="flex items-center w-full p-2 text-gray-900 transition duration-75 rounded-lg pl-11 group hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700"
            >
              ClickCB 3
            </a>
          </li>
          <li>
            <a
              href="/dashboard"
              class="flex items-center w-full p-2 text-gray-900 transition duration-75 rounded-lg pl-11 group hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700"
            >
              ClickCB 4
            </a>
          </li>
        </ul>
      </li>
      <li>
        <button
          type="button"
          class="flex items-center w-full p-2 text-base text-gray-900 transition duration-75 rounded-lg group hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700"
          aria-controls="dropdown-example"
          data-collapse-toggle="dropdown-example"
        >
          <svg
            class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 group-hover:text-gray-900 dark:text-gray-400 dark:group-hover:text-white"
            viewBox="-2 0 16 16"
            fill="currentColor"
            xmlns="http://www.w3.org/2000/svg"
            ><path
              data-name="Path 133"
              d="M10.5 0h-9A1.5 1.5 0 0 0 0 1.5V16h12V1.5A1.5 1.5 0 0 0 10.5 0M5 15v-3h2v3Zm6 0H8v-3.5a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5V15H1V1.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 .5.5ZM3 3h2v2H3Zm4 0h2v2H7ZM3 7h2v2H3Zm4 0h2v2H7Z"
            ></path></svg
          >
          <span class="flex-1 ms-3 text-left rtl:text-right whitespace-wrap"
            >Empresa de pruebas sistemas</span
          >
          <svg
            class="w-3 h-3"
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 10 6"
          >
            <path
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="m1 1 4 4 4-4"></path>
          </svg>
        </button>
        <ul id="dropdown-example" class="dropdown-content py-2 space-y-2">
          <li>
            <a
              href="/dashboard"
              class="flex items-center w-full p-2 text-gray-900 transition duration-75 rounded-lg pl-11 group hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700"
            >
              Matriz
            </a>
          </li>
          <li>
            <a
              href="/dashboard"
              class="flex items-center w-full p-2 text-gray-900 transition duration-75 rounded-lg pl-11 group hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700"
            >
              Central
            </a>
          </li>
          <li>
            <a
              href="/dashboard"
              class="flex items-center w-full p-2 text-gray-900 transition duration-75 rounded-lg pl-11 group hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700"
            >
              Extranjera
            </a>
          </li>
          <li>
            <a
              href="/dashboard"
              class="flex items-center w-full p-2 text-gray-900 transition duration-75 rounded-lg pl-11 group hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700"
            >
              Plaza 5
            </a>
          </li>
        </ul>
      </li>
      <li>
        <div
          class="flex items-center w-full p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group"
        >
          <svg
            class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 group-hover:text-gray-900 dark:text-gray-400 dark:group-hover:text-white"
            viewBox="-2 0 16 16"
            fill="currentColor"
            xmlns="http://www.w3.org/2000/svg"
            ><path
              data-name="Path 133"
              d="M10.5 0h-9A1.5 1.5 0 0 0 0 1.5V16h12V1.5A1.5 1.5 0 0 0 10.5 0M5 15v-3h2v3Zm6 0H8v-3.5a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5V15H1V1.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 .5.5ZM3 3h2v2H3Zm4 0h2v2H7ZM3 7h2v2H3Zm4 0h2v2H7Z"
            ></path></svg
          >

          <a
            href="/dashboard"
            class="flex-1 ms-3 text-left rtl:text-right whitespace-wrap"
          >
            <h4 class="text-sm font-semibold">Empresa Demo</h4>
          </a>
        </div>
      </li>
      <li>
        <div
          class="flex items-center w-full p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group"
        >
          <svg
            class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 group-hover:text-gray-900 dark:text-gray-400 dark:group-hover:text-white"
            viewBox="-2 0 16 16"
            fill="currentColor"
            xmlns="http://www.w3.org/2000/svg"
            ><path
              data-name="Path 133"
              d="M10.5 0h-9A1.5 1.5 0 0 0 0 1.5V16h12V1.5A1.5 1.5 0 0 0 10.5 0M5 15v-3h2v3Zm6 0H8v-3.5a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5V15H1V1.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 .5.5ZM3 3h2v2H3Zm4 0h2v2H7ZM3 7h2v2H3Zm4 0h2v2H7Z"
            ></path></svg
          >

          <a
            href="/dashboard"
            class="flex-1 ms-3 text-left rtl:text-right whitespace-wrap"
          >
            <h4 class="text-sm font-semibold">Empresa Demo DI99</h4>
          </a>
        </div>
      </li>
      <li>
        <div
          class="flex items-center w-full p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group"
        >
          <svg
            class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 group-hover:text-gray-900 dark:text-gray-400 dark:group-hover:text-white"
            viewBox="-2 0 16 16"
            fill="currentColor"
            xmlns="http://www.w3.org/2000/svg"
            ><path
              data-name="Path 133"
              d="M10.5 0h-9A1.5 1.5 0 0 0 0 1.5V16h12V1.5A1.5 1.5 0 0 0 10.5 0M5 15v-3h2v3Zm6 0H8v-3.5a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5V15H1V1.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 .5.5ZM3 3h2v2H3Zm4 0h2v2H7ZM3 7h2v2H3Zm4 0h2v2H7Z"
            ></path></svg
          >

          <a
            href="/dashboard"
            class="flex-1 ms-3 text-left rtl:text-right whitespace-wrap"
          >
            <h4 class="text-sm font-semibold">Grupo CA Resorts</h4>
          </a>
        </div>
      </li>
      <li>
        <div
          class="flex items-center w-full p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group"
        >
          <svg
            class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 group-hover:text-gray-900 dark:text-gray-400 dark:group-hover:text-white"
            viewBox="-2 0 16 16"
            fill="currentColor"
            xmlns="http://www.w3.org/2000/svg"
            ><path
              data-name="Path 133"
              d="M10.5 0h-9A1.5 1.5 0 0 0 0 1.5V16h12V1.5A1.5 1.5 0 0 0 10.5 0M5 15v-3h2v3Zm6 0H8v-3.5a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5V15H1V1.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 .5.5ZM3 3h2v2H3Zm4 0h2v2H7ZM3 7h2v2H3Zm4 0h2v2H7Z"
            ></path></svg
          >

          <a
            href="/dashboard"
            class="flex-1 ms-3 text-left rtl:text-right whitespace-wrap"
          >
            <h4 class="text-sm font-semibold">Guzdan Services</h4>
          </a>
        </div>
      </li>
      <li>
        <div
          class="flex items-center w-full p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group"
        >
          <svg
            class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 group-hover:text-gray-900 dark:text-gray-400 dark:group-hover:text-white"
            viewBox="-2 0 16 16"
            fill="currentColor"
            xmlns="http://www.w3.org/2000/svg"
            ><path
              data-name="Path 133"
              d="M10.5 0h-9A1.5 1.5 0 0 0 0 1.5V16h12V1.5A1.5 1.5 0 0 0 10.5 0M5 15v-3h2v3Zm6 0H8v-3.5a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5V15H1V1.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 .5.5ZM3 3h2v2H3Zm4 0h2v2H7ZM3 7h2v2H3Zm4 0h2v2H7Z"
            ></path></svg
          >

          <a
            href="/dashboard"
            class="flex-1 ms-3 text-left rtl:text-right whitespace-wrap"
          >
            <h4 class="text-sm font-semibold">Guzdan 3</h4>
          </a>
        </div>
      </li>
      <li>
        <div
          class="flex items-center w-full p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group"
        >
          <svg
            class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 group-hover:text-gray-900 dark:text-gray-400 dark:group-hover:text-white"
            viewBox="-2 0 16 16"
            fill="currentColor"
            xmlns="http://www.w3.org/2000/svg"
            ><path
              data-name="Path 133"
              d="M10.5 0h-9A1.5 1.5 0 0 0 0 1.5V16h12V1.5A1.5 1.5 0 0 0 10.5 0M5 15v-3h2v3Zm6 0H8v-3.5a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5V15H1V1.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 .5.5ZM3 3h2v2H3Zm4 0h2v2H7ZM3 7h2v2H3Zm4 0h2v2H7Z"
            ></path></svg
          >

          <a
            href="/dashboard"
            class="flex-1 ms-3 text-left rtl:text-right whitespace-wrap"
          >
            <h4 class="text-sm font-semibold">LogitLab</h4>
          </a>
        </div>
      </li>
      <li>
        <div
          class="flex items-center w-full p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group"
        >
          <svg
            class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 group-hover:text-gray-900 dark:text-gray-400 dark:group-hover:text-white"
            viewBox="-2 0 16 16"
            fill="currentColor"
            xmlns="http://www.w3.org/2000/svg"
            ><path
              data-name="Path 133"
              d="M10.5 0h-9A1.5 1.5 0 0 0 0 1.5V16h12V1.5A1.5 1.5 0 0 0 10.5 0M5 15v-3h2v3Zm6 0H8v-3.5a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5V15H1V1.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 .5.5ZM3 3h2v2H3Zm4 0h2v2H7ZM3 7h2v2H3Zm4 0h2v2H7Z"
            ></path></svg
          >

          <a
            href="/dashboard"
            class="flex-1 ms-3 text-left rtl:text-right whitespace-wrap"
          >
            <h4 class="text-sm font-semibold">LogitLab Replica</h4>
          </a>
        </div>
      </li>
    </ul>
  </div>
  <div class="py-4 overflow-y-auto">
    <ul class="space-y-2 font-medium">
      <li>
        <div
          class="flex items-center w-full p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group"
        >
          <svg
            class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 group-hover:text-gray-900 dark:text-gray-400 dark:group-hover:text-white"
            viewBox="0 0 32 32"
            fill="currentColor"
            xmlns="http://www.w3.org/2000/svg"
            ><path
              d="m23.265 24.381.9-.894c4.164.136 4.228-.01 4.411-.438l1.144-2.785.085-.264-.093-.231c-.049-.122-.2-.486-2.8-2.965V15.5c3-2.89 2.936-3.038 2.765-3.461l-1.139-2.814c-.171-.422-.236-.587-4.37-.474l-.9-.93a20 20 0 0 0-.141-4.106l-.116-.263-2.974-1.3c-.438-.2-.592-.272-3.4 2.786l-1.262-.019c-2.891-3.086-3.028-3.03-3.461-2.855L9.149 3.182c-.433.175-.586.237-.418 4.437l-.893.89c-4.162-.136-4.226.012-4.407.438l-1.146 2.786-.09.267.094.232c.049.12.194.48 2.8 2.962v1.3c-3 2.89-2.935 3.038-2.763 3.462l1.138 2.817c.174.431.236.584 4.369.476l.9.935a20.2 20.2 0 0 0 .137 4.1l.116.265 2.993 1.308c.435.182.586.247 3.386-2.8l1.262.016c2.895 3.09 3.043 3.03 3.466 2.859l2.759-1.115c.436-.173.588-.234.413-4.436m-11.858-6.524a4.957 4.957 0 1 1 6.488 2.824 5.014 5.014 0 0 1-6.488-2.824"
              style="fill:#40535b"></path></svg
          >
          <a
            href="/dashboard"
            class="flex-1 ms-3 text-left rtl:text-right whitespace-wrap"
          >
            <h4 class="text-sm font-semibold">Configuracion</h4>
          </a>
        </div>
      </li>
      <li>
        <div
          class="flex items-center w-full p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group"
        >
          <svg
            class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 group-hover:text-gray-900 dark:text-gray-400 dark:group-hover:text-white"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 52 52"
            fill="currentColor"
            xml:space="preserve"
            ><path
              d="M21 48.5v-3c0-.8-.7-1.5-1.5-1.5h-10c-.8 0-1.5-.7-1.5-1.5v-33C8 8.7 8.7 8 9.5 8h10c.8 0 1.5-.7 1.5-1.5v-3c0-.8-.7-1.5-1.5-1.5H6C3.8 2 2 3.8 2 6v40c0 2.2 1.8 4 4 4h13.5c.8 0 1.5-.7 1.5-1.5"
            ></path><path
              d="M49.6 27c.6-.6.6-1.5 0-2.1L36.1 11.4c-.6-.6-1.5-.6-2.1 0l-2.1 2.1c-.6.6-.6 1.5 0 2.1l5.6 5.6c.6.6.2 1.7-.7 1.7H15.5c-.8 0-1.5.6-1.5 1.4v3c0 .8.7 1.6 1.5 1.6h21.2c.9 0 1.3 1.1.7 1.7l-5.6 5.6c-.6.6-.6 1.5 0 2.1l2.1 2.1c.6.6 1.5.6 2.1 0z"
            ></path></svg
          >
          <a
            href="/dashboard"
            class="flex-1 ms-3 text-left rtl:text-right whitespace-wrap"
          >
            <h4 class="text-sm font-semibold">Salir</h4>
          </a>
        </div>
      </li>
    </ul>
  </div>
</div>

<div
  id="drawer-overlay"
  class="fixed inset-0 bg-gray-900 opacity-50 hidden z-30"
>
</div>

<script>
  interface HTMLElementWithStyle extends HTMLElement {
    style: CSSStyleDeclaration;
  }

  const drawer = document.getElementById(
    "drawer"
  ) as HTMLElementWithStyle | null;
  const drawerTrigger = document.getElementById("drawer-trigger");
  const drawerClose = document.getElementById("drawer-close");
  const overlay = document.getElementById("drawer-overlay");

  function openDrawer() {
    if (drawer && overlay) {
      drawer.classList.remove("-translate-x-full");
      overlay.classList.remove("hidden");
      document.body.style.overflow = "hidden";
    }
  }

  function closeDrawer() {
    if (drawer && overlay) {
      drawer.classList.add("-translate-x-full");
      overlay.classList.add("hidden");
      document.body.style.overflow = "";
    }
  }

  function setupDropdowns() {
    const dropdownButtons = document.querySelectorAll<HTMLElement>(
      "[data-collapse-toggle]"
    );

    dropdownButtons.forEach((button) => {
      button.addEventListener("click", (e) => {
        e.stopPropagation();
        const targetId = button.getAttribute("data-collapse-toggle");
        if (!targetId) return;

        const targetElement = document.getElementById(targetId);
        if (!targetElement) return;

        const otherDropdowns = document.querySelectorAll(
          ".dropdown-content.active"
        );
        otherDropdowns.forEach((dropdown) => {
          if (dropdown.id !== targetId) {
            dropdown.classList.remove("active");

            const otherButton = document.querySelector(
              `[data-collapse-toggle="${dropdown.id}"]`
            );
            const otherArrow = otherButton?.querySelector(
              "svg:last-child"
            ) as HTMLElement;
            if (otherArrow) {
              otherArrow.style.transform = "rotate(0deg)";
            }
            otherButton?.setAttribute("aria-expanded", "false");
          }
        });

        const isExpanding = !targetElement.classList.contains("active");
        targetElement.classList.toggle("active");

        const arrow = button.querySelector("svg:last-child") as HTMLElement;
        if (arrow) {
          arrow.style.transform = isExpanding
            ? "rotate(180deg)"
            : "rotate(0deg)";
        }

        button.setAttribute("aria-expanded", isExpanding.toString());
      });
    });
  }

  function initializeDropdowns() {
    const dropdowns = document.querySelectorAll<HTMLElement>(
      "[data-collapse-toggle]"
    );

    dropdowns.forEach((dropdown) => {
      const targetId = dropdown.getAttribute("data-collapse-toggle");
      if (!targetId) return;

      const content = document.getElementById(targetId);
      if (!content) return;

      content.classList.add("dropdown-content");

      dropdown.setAttribute("aria-expanded", "false");
    });

    setupDropdowns();
  }

  drawerTrigger?.addEventListener("click", openDrawer);
  drawerClose?.addEventListener("click", closeDrawer);
  overlay?.addEventListener("click", closeDrawer);

  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") {
      closeDrawer();
    }
  });

  document.addEventListener("click", (e) => {
    const target = e.target as HTMLElement;
    const isOutsideClick =
      drawer &&
      !drawer.contains(target) &&
      drawerTrigger &&
      !drawerTrigger.contains(target) &&
      !target.closest("[data-collapse-toggle]");

    if (isOutsideClick) {
      closeDrawer();
    }
  });

  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", initializeDropdowns);
  } else {
    initializeDropdowns();
  }
</script>

<style>
  #drawer {
    transition: transform 0.3s ease-in-out;
  }

  #drawer-overlay {
    transition: opacity 0.3s ease-in-out;
  }

  .dropdown-content {
    overflow: hidden;
    max-height: 0;
    opacity: 0;
    transition:
      max-height 0.3s ease-out,
      opacity 0.2s ease-out,
      padding 0.2s ease;
  }

  .dropdown-content.active {
    max-height: 500px;
    opacity: 1;
  }

  .hover\:bg-gray-100:hover {
    --tw-bg-opacity: 1;
    background-color: rgb(243 244 246 / var(--tw-bg-opacity));
  }

  .dark .dark\:hover\:bg-gray-700:hover {
    --tw-bg-opacity: 1;
    background-color: rgb(55 65 81 / var(--tw-bg-opacity));
  }

  [data-collapse-toggle] svg:last-child {
    transition: transform 0.3s ease;
  }
</style>
